<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorator="layout/main-layout-v1">
<head>
	<meta charset="UTF-8"/>
    <title>Quản lý người dùng</title>
	<link rel="stylesheet" th:href="@{/css/main.css}" href="../../css/main.css"/>
</head>
<body>
	<h3 layout:fragment="header"> QUẢN LÝ NGƯỜI DÙNG </h3>

	<ol layout:fragment="link">
		<li>
            <a th:href="@{/admin}"><i class="glyphicon glyphicon-user"></i> Quản lý Người dùng</a>
        </li>
	</ol>

	<section layout:fragment="content">
		<div th:if="${param.success}" class="alert alert-success fade in">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
			<strong>Thành công!</strong> Tài khoản <b th:text="${param.success[0]}"></b> đã được tạo mới.
		</div>
		<div th:if="${param.deleted}" class="alert alert-success fade in">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
			<strong>Thành công!</strong> Đã xóa tài khoản <b th:text="${param.deleted[0]}"></b>.
		</div>
		<div th:if="${param.error}" class="alert alert-danger fade in">
			<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
			<strong>Lỗi!</strong> Tài khoản <b th:text="${param.error[0]}"></b> đã tồn tại!
		</div>
		<h4>DANH SÁCH NGƯỜI DÙNG</h4>
		<hr/>
		<table class="table table-info table-striped table-bordered table-condensed">
			<thead>
				<tr>
					<th class="">#</th>
					<th class="col-sm-2">Tài khoản</th>
					<th class="col-sm-2">Họ tên</th>
					<th class="col-sm-4">Địa chỉ</th>
					<th class="col-sm-2">Số điện thoại</th>
					<th class="col-sm-2">Công cụ</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="user, int : ${users}" class="clickable">
					<td class="" th:text="${int.index + 1}"></td>
					<td class="col-sm-2" th:text="${user.username}"></td>
					<td class="col-sm-2" th:text="${user.userDetail.fullName}"></td>
					<td class="col-sm-4" th:text="${#strings.toString(user.userDetail.address)}"></td>
					<td class="col-sm-2" th:text="${user.userDetail.phone}"></td>
					<td class="col-sm-2">
						<a th:href="@{/view-user?username=} + ${user.username}" class="btn btn-default btn-xs btn-view">
							<i class="glyphicon glyphicon-eye-open"></i>
						</a> -
						<a th:href="@{/update-user?username=} + ${user.username}" class="btn btn-default btn-xs btn-edit">
							<i class="glyphicon glyphicon-edit"></i>
						</a> -
						<a th:href="@{/delete-user?username=} + ${user.username}" class="btn btn-default btn-xs btn-remove">
							<i class="glyphicon glyphicon-remove"></i>
						</a>
					</td>
				</tr>
			</tbody>
		</table>
		<!-- Paging -->
		<div class="row">
			<div th:if="${users.totalPages >= 1}"
				 class="col-md-12 pagination-centered">
				<ul class="pagination">
					<li th:class="${users.number == 0} ? disabled">
						<a class="pageLink" th:href="@{/admin?(pageSize=${selectedPageSize}, page=1)}">&laquo;</a>
					</li>
					<li th:class="${users.number == 0} ? disabled">
						<a class="pageLink" th:href="@{/admin?(pageSize=${selectedPageSize}, page=${users.number})}">&larr;</a>
					</li>
					<li th:class="${users.number == (page - 1)} ? 'active pointer-disabled'" th:each="page : ${#numbers.sequence(pager.startPage, pager.endPage)}">
						<a class="pageLink" th:href="@{/admin?(pageSize=${selectedPageSize}, page=${page})}" th:text="${page}"></a>
					</li>
					<li th:class="${users.number + 1 == users.totalPages} ? disabled">
						<a class="pageLink" th:href="@{/admin?(pageSize=${selectedPageSize}, page=${users.number + 2})}">&rarr;</a>
					</li>
					<li th:class="${users.number + 1 == users.totalPages} ? disabled">
						<a class="pageLink" th:href="@{/admin?(pageSize=${selectedPageSize}, page=${users.totalPages})}">&raquo;</a>
					</li>
				</ul>
			</div>
		</div>
		<!-- End Paging -->
		<hr/>
		<div class="row">
			<div class="col-sm-6">
				<div class="panel panel-success">
				  	<div class="panel-heading">THÊM MỚI</div>
				  	<div class="panel-body">
				  		<div class="container-fluid">
							<form th:action="@{/create-user}" th:method="post" th:object="${newUser}">
								<div class="form-group">
								  	<label for="username">Nhập tài khoản:</label>
								  	<input type="text" class="form-control" id="username" th:field="*{username}" required="required"/>
								</div>
								<div class="form-group">
								  	<label for="password">Nhật mật khẩu</label>
								  	<input type="password" class="form-control" id="password" th:field="*{password}" required="required"/>
								</div>
								<div class="form-group">
								  	<label for="userRole">Phân quyền cho tài khoản:</label>
									<select class="form-control" id="userRole" th:field="*{userRole}">
										<option th:each="role : ${roles}"
												th:value="${role.roleName}"
												th:text="${role.roleName} + ' -- ' + ${role.detail}">
										</option>
									</select>
								</div>
								<div class="form-group text-right">
									<button type="submit" class="btn btn-primary" id="btnUpdate">Thêm mới</button>
									<button type="reset" class="btn btn-warning" id="btnReset">Làm mới</button>
								</div>
							</form>
						</div>
				  	</div>
				</div>
			</div>
			<div class="col-sm-6">
				<div class="panel panel-warning">
				  	<div class="panel-heading">CHÚ THÍCH</div>
				  	<div class="panel-body">
				  		Text here
				  	</div>
				</div>
			</div>
		</div>

		<span id="menuItem" class="hidden">#user</span>
	</section>
</body>
</html>
